<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <!-- <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script> -->
        <script src="https://raw.githack.com/AR-js-org/AR.js/3.0.0/aframe/build/aframe-ar-nft.js"></script>
        <script>
            AFRAME.registerComponent('light-distance', {
                schema: {
                    minDistance: { type: 'number', default: 15 },
                    maxDistance: { type: 'number', default: 40 },
                },

                tick: function () {
                    // カメラの位置を取得
                    const cameraPosition = this.el.sceneEl.camera.el.object3D.position;
                    // 画像の位置を取得
                    const imagePosition = this.el.object3D.position;
                    // 2点間の距離を計算
                    const distance = cameraPosition.distanceTo(imagePosition);

                    // 明るさの調整
                    let brightness = 1;
                    if (distance < this.data.minDistance) {
                        brightness = 1;
                    } else if (distance > this.data.maxDistance) {
                        brightness = 0;
                    } else {
                        const range = this.data.maxDistance - this.data.minDistance;
                        const ratio = (distance - this.data.minDistance) / range;
                        brightness = 1 - ratio;
                    }

                    // 画像のマテリアルの色を変更して明るさを調整
                    const r = 255 * brightness;
                    const g = 255 * brightness;
                    const b = 255 * brightness;
                    this.el.setAttribute('material', 'color', `rgb(${r}, ${g}, ${b})`);

                },
            });
        </script>

<script>
    function getLastModified() {
        const xhr = new XMLHttpRequest();
        xhr.open('HEAD', window.location.href, false);
        xhr.send(null);
        const lastModified = new Date(xhr.getResponseHeader('Last-Modified'));
        return lastModified;
    }

    function formatDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const hours = String(date.getHours()).padStart(2, '0');
        const minutes = String(date.getMinutes()).padStart(2, '0');
        const seconds = String(date.getSeconds()).padStart(2, '0');

        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }

    document.addEventListener('DOMContentLoaded', () => {
        const lastModified = getLastModified();
        const formattedDate = formatDate(lastModified);
        document.getElementById('version-info').innerText = `最終変更日時: ${formattedDate}`;
    });
</script>


        <style>#version-info {
        position: fixed;
        bottom: 10px;
        right: 10px;
        font-size: 14px;
        color: #ffffff;
        background-color: rgba(0, 0, 0, 0.7);
        padding: 5px 10px;
        border-radius: 5px;}
        </style>

    </head>

    <body style="margin: 0; overflow: hidden;">
        <a-scene
            embedded
            loading-screen="enabled: false;"
            arjs="sourceType: webcam; debugUIEnabled: false;"
        >
            <a-image
                src="assets/michikusa.png"
                look-at="[gps-camera]"
                scale="5 5 1"
                light-distance
                gps-entity-place="latitude:24.34031586062179; longitude:124.15826261612321;"
            ></a-image>

            <a-image
                src="assets/klatch.png"
                look-at="[gps-camera]"
                scale="5 5 1"
                light-distance
                gps-entity-place="latitude:24.340537303621755; longitude:124.15833679907587;"
            ></a-image>

            <a-image
                src="assets/cotton.png"
                look-at="[gps-camera]"
                scale="5 5 1"
                light-distance
                gps-entity-place="latitude:24.340054755073425; longitude:124.15845538605058;"
            ></a-image>
            
            <a-image
                src="assets/comecome.png"
                look-at="[gps-camera]"
                scale="5 5 1"
                light-distance
                gps-entity-place="latitude:24.340886042637198; longitude:124.15771680158518;"
                ></a-image>

            <a-image
                src="assets/cloudnine.png"
                look-at="[gps-camera]"
                scale="5 5 1"
                light-distance
                gps-entity-place="latitude:24.34037620150987; longitude:124.15824490484546;"
                ></a-image>                
    
                <a-image
                    src="assets/maie.png"
                    look-at="[gps-camera]"
                    scale="5 5 1"
                    light-distance
                    gps-entity-place="latitude:24.34025369539998; longitude:124.15835186617635;"
                ></a-image>
    
                <a-image
                    src="assets/penguin.png"
                    look-at="[gps-camera]"
                    scale="5 5 1"
                    light-distance
                    gps-entity-place="latitude:24.340191368764113; longitude:124.1583587245452;"
                ></a-image>
    
                <a-image
                    src="assets/shimashima.png"
                    look-at="[gps-camera]"
                    scale="5 5 1"
                    light-distance
                    gps-entity-place="latitude:24.33988775219514; longitude:124.15845642072118;"
                ></a-image>
    
                <a-image
                    src="assets/tomo.png"
                    look-at="[gps-camera]"
                    scale="5 5 1"
                    light-distance
                    gps-entity-place="latitude:24.33989917797152; longitude:124.15856872619108;"
                ></a-image>
    
                <a-image
                    src="assets/view.png"
                    look-at="[gps-camera]"
                    scale="5 5 1"
                    light-distance
                    gps-entity-place="latitude:24.339893861709967; longitude:124.15856437963475;"
                ></a-image>
    
                <a-camera gps-camera="gpsMinDistance:2; maxDistance:100;" rotation-reader> </a-camera>
            </a-scene>

            <div id="version-info">
            </div>
            
            
        </body>
    </html>
